var GustCalendar=function(b){var c,t,p,k,w,E,D,a,f,u=0,l=0,J=0,g,h;(function(){c=[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42448,83315,21200,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46496,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448];t=[31,28,31,30,31,30,31,31,30,31,30,31];p=["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"];k=["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"];w=[0,21208,42467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758];E=["日","一","二","三","四","五","六","七","八","九","十"];D=["初","十","廿","卅"];a=["0101 元旦","0214 情人节","0308 妇女节","0312 植树节","0315 消费者权益日","0401 愚人节","0501 劳动节","0504 青年节","0512 护士节","0601 儿童节","0701 建党节","0801 建军节","0910 教师节","0928 孔子诞辰","1001 国庆节","1006 老人节","1024 联合国日","1224 平安夜","1225 圣诞节"];f=["0101 春节","0115 元宵节","0505 端午节","0707 七夕节","0715 中元节","0815 中秋节","0909 重阳节","1208 腊八节","1224 小年"]})();var d=function(M){var K,L=348;for(K=32768;K>8;K>>=1){L+=(c[M-1900]&K)?1:0}return(L+e(M))};var e=function(K){if(z(K)){return((c[K-1900]&65536)?30:29)}else{return(0)}};var z=function(K){return(c[K-1900]&15)};var A=function(L,K){return((c[L-1900]&(65536>>K))?30:29)};var C=function(L,K){if(K==1){return(((L%4==0)&&(L%100!=0)||(L%400==0))?29:28)}else{return(t[K])}};var I=function(M,L){var K=new Date((31556925974.7*(M-1900)+w[L]*60000)+Date.UTC(1900,0,6,2,5));return(K.getUTCDate())};var m=9,s=9,y=0;var F=function(L){var K;switch(L){case 10:K="初十";break;case 20:K="二十";break;break;case 30:K="三十";break;break;default:K=D[Math.floor(L/10)];K+=E[L%10]}return(K)};var j;var n=function(M,U){l=M;u=U;b.find(".console .year .label").text(M+"年");b.find(".console .month .label").text((U+1)+"月");var O,K,W;j=B(M,U);var T=p[(M-4)%12];for(O=0;O<42;O++){var Q=g.find("#GD"+O);var P=g.find("#SD"+O)[0];var N=g.find("#LD"+O)[0];K=O-j.firstWeek;if(K>-1&&K<j.length){Q.removeClass("disable");P.innerHTML=K+1;Q.attr("data-value",K+1);if(j[K].isToday){Q.addClass("today")}else{Q.removeClass("today")}if(j[K].lDay==1){N.innerHTML="<b>"+(j[K].isLeap?"闰":"")+j[K].lMonth+"月"+(A(j[K].lYear,j[K].lMonth)==29?"小":"大")+"</b>"}else{N.innerHTML=F(j[K].lDay)}var L=null,R=null;W=j[K].solarFestival;for(var V=0;V<f.length;V++){if(parseInt(f[V].substr(0,2))==(j[K].lMonth)){if(parseInt(f[V].substr(2,4))==(j[K].lDay)){N.innerHTML=f[V].substr(5);L=f[V].substr(5)}}if(12==(j[K].lMonth)){if(y==(j[K].lDay)){N.innerHTML="除夕";L="除夕"}}}for(var V=0;V<a.length;V++){if(parseInt(a[V].substr(0,2))==(U+1)){if(parseInt(a[V].substr(2,4))==(K+1)){N.innerHTML=a[V].substr(5);R=a[V].substr(5)}}}if((U+1)==5){if(m==0){if((K+1)==7){R="母亲节";N.innerHTML="母亲节"}}else{if(m<9){if((K+1)==((7-m)+8)){R="母亲节";N.innerHTML="母亲节"}}}}if((U+1)==6){if(s==0){if((K+1)==14){R="父亲节";N.innerHTML="父亲节"}}else{if(s<9){if((K+1)==((7-s)+15)){R="父亲节";N.innerHTML="父亲节"}}}}if(W.length<=0){W=j[K].solarTerms;if(W.length>0){W=W.fontcolor("limegreen")}}if(W.length>0){N.innerHTML=W;L=W}if((L!=null)&&(R!=null)){N.innerHTML=L+"/"+R}}else{Q.addClass("disable");Q.attr("data-value","");if(K<0){var S=new Date(U>0?M:M-1,U>0?U:12,0).getDate();P.innerHTML=S+K+1;N.innerHTML=""}else{P.innerHTML=K-j.length+1;N.innerHTML=""}}}b.find(".date-grid.active").removeClass("active");if(null!=J){if(l==J.year&&u==J.month){b.find('.date-grid[data-value="'+J.date+'"]').addClass("active")}}};var i=new Date().getFullYear(),o=new Date().getMonth(),r=new Date().getDate();var q=function(U){var O,K=0,W=0;var L=new Date(1900,0,31);var N=(U-L)/86400000;var P=N+40;var V=14;for(O=1900;O<2050&&N>0;O++){W=d(O);N-=W;V+=12}if(N<0){N+=W;O--;V-=12}var R=O;var M=O-1864;K=z(O);var T=false;for(O=1;O<13&&N>0;O++){if(K>0&&O==(K+1)&&T==false){--O;T=true;W=e(R)}else{W=A(R,O)}if(T==true&&O==(K+1)){T=false}N-=W;if(T==false){V++}}if(N==0&&K>0&&O==K+1){if(T){T=false}else{T=true;--O;--V}}if(N<0){N+=W;--O;--V}var Q=O;var S=N+1;return{dayCyl:P,monCyl:V,year:R,yearCyl:M,isLeap:T,month:Q,day:S}};var v=function(R,K,P,O,L,Q,N,M){return{isToday:false,sYear:R,sMonth:K,sDay:P,week:O,lYear:L,lMonth:Q,lDay:N,isLeap:M,lunarFestival:"",solarFestival:"",solarTerms:""}};var B=function(Y,P){m=s=0;var Z,S,W,L,V=1,M,X=0,R,Q;var N=new Array(3);var O=0;var K=0;Z=new Date(Y,P,1);var U={};U.length=C(Y,P);U.firstWeek=Z.getDay();if((P+1)==5){m=Z.getDay()}if((P+1)==6){s=Z.getDay()}for(var T=0;T<U.length;T++){if(V>X){Z=new Date(Y,P,T+1);S=q(Z);W=S.year;L=S.month;V=S.day;M=S.isLeap;X=M?e(W):A(W,L);if(L==12){y=X}if(O==0){K=L}N[O++]=T-V+1}U[T]=v(Y,P+1,T+1,E[(T+U.firstWeek)%7],W,L,V++,M);if((T+U.firstWeek)%7==0){U[T].color="red"}}R=I(Y,P*2)-1;Q=I(Y,P*2+1)-1;U[R].solarTerms=k[P*2];U[Q].solarTerms=k[P*2+1];if((U.firstWeek+12)%7==5){U[12].solarFestival+="黑色星期五"}if(Y==i&&P==o){U[r-1].isToday=true}return U};var x=function(){for(var O=0;O<6;O++){var N=document.createElement("div");if(O==5){N.className="date-grid-row last"}else{N.className="date-grid-row"}for(var M=0;M<7;M++){var L=O*7+M;var K=document.createElement("div");K.id="GD"+L;if(M==6){K.className="date-grid last"}else{K.className="date-grid"}var Q=document.createElement("span");Q.id="SD"+L;Q.className="sd";var P=document.createElement("span");P.id="LD"+L;P.className="ld";K.appendChild(Q);K.appendChild(P);N.appendChild(K)}g[0].appendChild(N)}};this.enableView=function(){var N='<div class="console"><div class="year"><div class="prev-btn">&lt;</div><div class="next-btn">&gt;</div><div class="label"></div></div><div class="month"><div class="prev-btn">&lt;</div><div class="next-btn">&gt;</div><div class="label"></div></div></div>';var L='<div class="week"><div class="label">日</div><div class="label">一</div><div class="label">二</div><div class="label">三</div><div class="label">四</div><div class="label">五</div><div class="label">六</div></div>';var M='<div class="grids"></div>';b.append(N+L+M);g=b.find(".grids");x();n(i,o);var K=this;b.find(".console .year .prev-btn").click(function(){K.prevYear()});b.find(".console .year .next-btn").click(function(){K.nextYear()});b.find(".console .month .prev-btn").click(function(){K.prevMonth()});b.find(".console .month .next-btn").click(function(){K.nextMonth()})};var H,G;this.enableFormControl=function(){h=b;var K=this;var L=false;H=function(){if(!L){L=true;var M=h.offset().left;var R=h.offset().top+h.outerHeight();var Q=$("body").width()-$("body").offset().left;var P=$("body").height()-$("body").offset().top;if(M+308>Q){M=Q-313}if(R+339>P){R=P-344}var N="left: "+M+"px; top: "+R+"px;";b=$('<div id="__gust_calender_container" style="'+N+'"></div>').appendTo("body");K.enableView();if(""!=h.val()){var O=h.val().split("-");if(O.length>=3){K.gotoDate(parseInt(O[0]),parseInt(O[1]),parseInt(O[2]))}}G=function(S){if($(S.target).closest(b).length==0){L=false;b.empty();b.remove();document.body.removeEventListener("click",G,true)}};document.body.addEventListener("click",G,true);b.find(".grids .date-grid").click(function(){if(!$(this).hasClass("disable")){b.find(".grids .date-grid.active").removeClass("active");$(this).addClass("active");L=false;b.empty();b.remove();document.body.removeEventListener("click",G,true);var S=u+1;var T=$(this).find(".sd").html();h.val(l+"-"+(S<10?"0"+S:S)+"-"+(T<10?"0"+T:T))}})}};h[0].addEventListener("click",H,true)};this.destroy=function(){b.empty();if(null!=h){h[0].removeEventListener("click",H,true);if(null!=b){b.remove()}}if(null!=G){document.body.removeEventListener("click",G,true)}h=null;H=null;G=null;b=null};this.prevYear=function(){if(l==1900){n(2050,u)}else{n(l-1,u)}};this.nextYear=function(){if(l==2050){n(1900,u)}else{n(l+1,u)}};this.prevMonth=function(){if(u==0){n(l-1,11)}else{n(l,u-1)}};this.nextMonth=function(){if(u==11){n(l+1,0)}else{n(l,u+1)}};this.gotoDate=function(L,M,K){if(null!=K){J={year:L,month:M-1,date:K}}n(L,M-1)};this.getYear=function(){return l};this.getMonth=function(){return u}};