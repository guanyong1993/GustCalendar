var GustCalendar=function(b,d,M,g,o){var c,x,t,n,A,K,J,a,h,z=0,p=0,Q=0,i,k;var j=function(R){var S=[];for(var T=0;T<R.length;T++){S[T]=parseInt(R[T],10)}return S};if(null!=g){g=j(g.split("-"))}if(null!=o){o=j(o.split("-"))}(function(){c=[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42448,83315,21200,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46496,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448];x=[31,28,31,30,31,30,31,31,30,31,30,31];t=["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"];n=["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"];A=[0,21208,42467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758];K=["日","一","二","三","四","五","六","七","八","九","十"];J=["初","十","廿","卅"];a=["0101 元旦","0214 情人节","0308 妇女节","0312 植树节","0315 消费者权益日","0401 愚人节","0501 劳动节","0504 青年节","0512 护士节","0601 儿童节","0701 建党节","0801 建军节","0910 教师节","0928 孔子诞辰","1001 国庆节","1006 老人节","1024 联合国日","1224 平安夜","1225 圣诞节"];h=["0101 春节","0115 元宵节","0505 端午节","0707 七夕节","0715 中元节","0815 中秋节","0909 重阳节","1208 腊八节","1224 小年"]})();var e=function(T){var R,S=348;for(R=32768;R>8;R>>=1){S+=(c[T-1900]&R)?1:0}return(S+f(T))};var f=function(R){if(F(R)){return((c[R-1900]&65536)?30:29)}else{return(0)}};var F=function(R){return(c[R-1900]&15)};var H=function(S,R){return((c[S-1900]&(65536>>R))?30:29)};var I=function(S,R){if(R==1){return(((S%4==0)&&(S%100!=0)||(S%400==0))?29:28)}else{return(x[R])}};var P=function(T,S){var R=new Date((31556925974.7*(T-1900)+A[S]*60000)+Date.UTC(1900,0,6,2,5));return(R.getUTCDate())};var q=9,w=9,E=0;var L=function(S){var R;switch(S){case 10:R="初十";break;case 20:R="二十";break;break;case 30:R="三十";break;break;default:R=J[Math.floor(S/10)];R+=K[S%10]}return(R)};var m;var D=function(S){var R=["一","二","三","四","五","六","七","八","九","十","十一","十二"];return R[S-1]};var r=function(Y,ac){p=Y;z=ac;b.find(".console .year .label").text(d?(d.replace("yyyy",Y)):(Y+"年"));b.find(".console .month .label").text(M?(M.replace("@M",D(ac+1)).replace("MM",ac)):((ac+1)+"月"));var af,ad,Z;m=G(Y,ac);var aa=t[(Y-4)%12];var R=false,ae=false,X=false,al=false;if(null!=g){var ai=g[0],T=g[1];R=(Y<ai)||(Y==ai&&ac+1<T);ae=(Y==ai)&&(ac+1==T)}if(null!=o){var ah=o[0],S=o[1];X=(Y>ah)||(Y==ah&&ac+1>S);al=(Y==ah)&&(ac+1==S)}for(af=0;af<42;af++){var U=i.find("#GD"+af);var ak=i.find("#SD"+af)[0];var aj=i.find("#LD"+af)[0];ad=af-m.firstWeek;if(ad>-1&&ad<m.length){if((R||(ae&&(ad+1)<g[2]))||(X||(al&&(ad+1)>o[2]))){U.addClass("disable")}else{U.removeClass("disable")}ak.innerHTML=ad+1;U.attr("data-value",ad+1);if(m[ad].isToday){U.addClass("today")}else{U.removeClass("today")}if(m[ad].lDay==1){aj.innerHTML="<b>"+(m[ad].isLeap?"闰":"")+m[ad].lMonth+"月"+(H(m[ad].lYear,m[ad].lMonth)==29?"小":"大")+"</b>"}else{aj.innerHTML=L(m[ad].lDay)}var W=null,V=null;Z=m[ad].solarFestival;for(var ag=0;ag<h.length;ag++){if(parseInt(h[ag].substr(0,2))==(m[ad].lMonth)){if(parseInt(h[ag].substr(2,4))==(m[ad].lDay)){aj.innerHTML=h[ag].substr(5);W=h[ag].substr(5)}}if(12==(m[ad].lMonth)){if(E==(m[ad].lDay)){aj.innerHTML="除夕";W="除夕"}}}for(var ag=0;ag<a.length;ag++){if(parseInt(a[ag].substr(0,2))==(ac+1)){if(parseInt(a[ag].substr(2,4))==(ad+1)){aj.innerHTML=a[ag].substr(5);V=a[ag].substr(5)}}}if((ac+1)==5){if(q==0){if((ad+1)==7){V="母亲节";aj.innerHTML="母亲节"}}else{if(q<9){if((ad+1)==((7-q)+8)){V="母亲节";aj.innerHTML="母亲节"}}}}if((ac+1)==6){if(w==0){if((ad+1)==14){V="父亲节";aj.innerHTML="父亲节"}}else{if(w<9){if((ad+1)==((7-w)+15)){V="父亲节";aj.innerHTML="父亲节"}}}}if(Z.length<=0){Z=m[ad].solarTerms;if(Z.length>0){Z=Z.fontcolor("limegreen")}}if(Z.length>0){aj.innerHTML=Z;W=Z}if((W!=null)&&(V!=null)){aj.innerHTML=W+"/"+V}}else{U.addClass("disable");U.attr("data-value","");if(ad<0){var ab=new Date(ac>0?Y:Y-1,ac>0?ac:12,0).getDate();ak.innerHTML=ab+ad+1;aj.innerHTML=""}else{ak.innerHTML=ad-m.length+1;aj.innerHTML=""}}}b.find(".date-grid.active").removeClass("active");if(null!=Q){if(p==Q.year&&z==Q.month){b.find('.date-grid[data-value="'+Q.date+'"]').addClass("active")}}};var l=new Date().getFullYear(),s=new Date().getMonth(),v=new Date().getDate();var u=function(ab){var V,R=0,ad=0;var S=new Date(1900,0,31);var U=(ab-S)/86400000;var W=U+40;var ac=14;for(V=1900;V<2050&&U>0;V++){ad=e(V);U-=ad;ac+=12}if(U<0){U+=ad;V--;ac-=12}var Y=V;var T=V-1864;R=F(V);var aa=false;for(V=1;V<13&&U>0;V++){if(R>0&&V==(R+1)&&aa==false){--V;aa=true;ad=f(Y)}else{ad=H(Y,V)}if(aa==true&&V==(R+1)){aa=false}U-=ad;if(aa==false){ac++}}if(U==0&&R>0&&V==R+1){if(aa){aa=false}else{aa=true;--V;--ac}}if(U<0){U+=ad;--V;--ac}var X=V;var Z=U+1;return{dayCyl:W,monCyl:ac,year:Y,yearCyl:T,isLeap:aa,month:X,day:Z}};var y=function(Y,R,W,V,S,X,U,T){return{isToday:false,sYear:Y,sMonth:R,sDay:W,week:V,lYear:S,lMonth:X,lDay:U,isLeap:T,lunarFestival:"",solarFestival:"",solarTerms:""}};var G=function(af,W){q=w=0;var ag,Z,ad,S,ac=1,T,ae=0,Y,X;var U=new Array(3);var V=0;var R=0;ag=new Date(af,W,1);var ab={};ab.length=I(af,W);ab.firstWeek=ag.getDay();if((W+1)==5){q=ag.getDay()}if((W+1)==6){w=ag.getDay()}for(var aa=0;aa<ab.length;aa++){if(ac>ae){ag=new Date(af,W,aa+1);Z=u(ag);ad=Z.year;S=Z.month;ac=Z.day;T=Z.isLeap;ae=T?f(ad):H(ad,S);if(S==12){E=ae}if(V==0){R=S}U[V++]=aa-ac+1}ab[aa]=y(af,W+1,aa+1,K[(aa+ab.firstWeek)%7],ad,S,ac++,T);if((aa+ab.firstWeek)%7==0){ab[aa].color="red"}}Y=P(af,W*2)-1;X=P(af,W*2+1)-1;ab[Y].solarTerms=n[W*2];ab[X].solarTerms=n[W*2+1];if((ab.firstWeek+12)%7==5){ab[12].solarFestival+="黑色星期五"}if(af==l&&W==s){ab[v-1].isToday=true}return ab};var C=function(){for(var V=0;V<6;V++){var U=document.createElement("div");if(V==5){U.className="date-grid-row last"}else{U.className="date-grid-row"}for(var T=0;T<7;T++){var S=V*7+T;var R=document.createElement("div");R.id="GD"+S;if(T==6){R.className="date-grid last"}else{R.className="date-grid"}var X=document.createElement("span");X.id="SD"+S;X.className="sd";var W=document.createElement("span");W.id="LD"+S;W.className="ld";R.appendChild(X);R.appendChild(W);U.appendChild(R)}i[0].appendChild(U)}};this.enableView=function(){var U='<div class="console"><div class="year"><div class="prev-btn">&lt;</div><div class="next-btn">&gt;</div><div class="label"></div></div><div class="month"><div class="prev-btn">&lt;</div><div class="next-btn">&gt;</div><div class="label"></div></div></div>';var S='<div class="week"><div class="label">日</div><div class="label">一</div><div class="label">二</div><div class="label">三</div><div class="label">四</div><div class="label">五</div><div class="label">六</div></div>';var T='<div class="grids"></div>';b.append(U+S+T);i=b.find(".grids");C();r(l,s);var R=this;b.find(".console .year .prev-btn").click(function(){R.prevYear()});b.find(".console .year .next-btn").click(function(){R.nextYear()});b.find(".console .month .prev-btn").click(function(){R.prevMonth()});b.find(".console .month .next-btn").click(function(){R.nextMonth()})};var O,N;this.enableFormControl=function(T){k=b;b=null;var R=this;var S=false;O=function(){if(!S){S=true;var U=k.offset().left;var Z=k.offset().top+k.outerHeight();var Y=$("body").width()-$("body").offset().left;var X=$("body").height()-$("body").offset().top;if(U+308>Y){U=Y-313}if(Z+339>X){Z=X-344}var V="left: "+U+"px; top: "+Z+"px;";b=$('<div id="__gust_calender_container" class="'+(T?T:"")+'" style="'+V+'"></div>').appendTo("body");R.enableView();if(""!=k.val()){var W=k.val().split("-");if(W.length>=3){B(parseInt(W[0]),parseInt(W[1]),parseInt(W[2]))}}N=function(aa){if($(aa.target).closest(b).length==0){S=false;b.empty();b.remove();document.body.removeEventListener("click",N,true)}};document.body.addEventListener("click",N,true);b.find(".grids .date-grid").click(function(){if(!$(this).hasClass("disable")){b.find(".grids .date-grid.active").removeClass("active");$(this).addClass("active");S=false;b.empty();b.remove();document.body.removeEventListener("click",N,true);var aa=z+1;var ab=$(this).find(".sd").html();k.val(p+"-"+(aa<10?"0"+aa:aa)+"-"+(ab<10?"0"+ab:ab));if(typeof R.onChange=="function"){R.onChange(p,aa,ab)}}})}};k[0].addEventListener("click",O,true)};this.destroy=function(){if(null!=b){b.empty()}if(null!=k){k[0].removeEventListener("click",O,true);if(null!=b){b.remove()}}if(null!=N){document.body.removeEventListener("click",N,true)}k=null;O=null;N=null;b=null};this.prevYear=function(){if(p==1900){r(2050,z)}else{r(p-1,z)}};this.nextYear=function(){if(p==2050){r(1900,z)}else{r(p+1,z)}};this.prevMonth=function(){if(z==0){r(p-1,11)}else{r(p,z-1)}};this.nextMonth=function(){if(z==11){r(p+1,0)}else{r(p,z+1)}};var B=function(S,T,R){if(null!=R){Q={year:S,month:T-1,date:R}}if($("#__gust_calender_container").length>0){r(S,T-1)}};this.gotoDate=function(S,T,R){B(S,T,R);if(typeof this.onChange=="function"){this.onChange(S,T,R)}};this.getYear=function(){return p};this.getMonth=function(){return z};this.onChange=function(S,T,R){}};