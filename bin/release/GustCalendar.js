var GustCalendar=function(b,d,N,g,p){var c,y,u,o,B,L,K,a,h,A=0,q=0,R=0,i,k,l=this;var j=function(S){var T=[];for(var U=0;U<S.length;U++){T[U]=parseInt(S[U],10)}return T};if(null!=g){g=j(g.split("-"))}if(null!=p){p=j(p.split("-"))}(function(){c=[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42448,83315,21200,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46496,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448];y=[31,28,31,30,31,30,31,31,30,31,30,31];u=["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"];o=["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"];B=[0,21208,42467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758];L=["日","一","二","三","四","五","六","七","八","九","十"];K=["初","十","廿","卅"];a=["0101 元旦","0214 情人节","0308 妇女节","0312 植树节","0315 消费者权益日","0401 愚人节","0501 劳动节","0504 青年节","0512 护士节","0601 儿童节","0701 建党节","0801 建军节","0910 教师节","0928 孔子诞辰","1001 国庆节","1006 老人节","1024 联合国日","1224 平安夜","1225 圣诞节"];h=["0101 春节","0115 元宵节","0505 端午节","0707 七夕节","0715 中元节","0815 中秋节","0909 重阳节","1208 腊八节","1224 小年"]})();var e=function(U){var S,T=348;for(S=32768;S>8;S>>=1){T+=(c[U-1900]&S)?1:0}return(T+f(U))};var f=function(S){if(G(S)){return((c[S-1900]&65536)?30:29)}else{return(0)}};var G=function(S){return(c[S-1900]&15)};var I=function(T,S){return((c[T-1900]&(65536>>S))?30:29)};var J=function(T,S){if(S==1){return(((T%4==0)&&(T%100!=0)||(T%400==0))?29:28)}else{return(y[S])}};var Q=function(U,T){var S=new Date((31556925974.7*(U-1900)+B[T]*60000)+Date.UTC(1900,0,6,2,5));return(S.getUTCDate())};var r=9,x=9,F=0;var M=function(T){var S;switch(T){case 10:S="初十";break;case 20:S="二十";break;break;case 30:S="三十";break;break;default:S=K[Math.floor(T/10)];S+=L[T%10]}return(S)};var n;var E=function(T){var S=["一","二","三","四","五","六","七","八","九","十","十一","十二"];return S[T-1]};var s=function(Z,ad){q=Z;A=ad;b.find(".console .year .label").text(d?(d.replace("yyyy",Z)):(Z+"年"));b.find(".console .month .label").text(N?(N.replace("@M",E(ad+1)).replace("MM",ad+1)):((ad+1)+"月"));var ag,ae,aa;n=H(Z,ad);var ab=u[(Z-4)%12];var S=false,af=false,Y=false,am=false;if(null!=g){var aj=g[0],U=g[1];S=(Z<aj)||(Z==aj&&ad+1<U);af=(Z==aj)&&(ad+1==U)}if(null!=p){var ai=p[0],T=p[1];Y=(Z>ai)||(Z==ai&&ad+1>T);am=(Z==ai)&&(ad+1==T)}for(ag=0;ag<42;ag++){var V=i.find("#GD"+ag);var al=i.find("#SD"+ag)[0];var ak=i.find("#LD"+ag)[0];ae=ag-n.firstWeek;if(ae>-1&&ae<n.length){if((S||(af&&(ae+1)<g[2]))||(Y||(am&&(ae+1)>p[2]))){V.addClass("disable")}else{V.removeClass("disable")}al.innerHTML=ae+1;V.attr("data-value",ae+1);if(n[ae].isToday){V.addClass("today")}else{V.removeClass("today")}if(n[ae].lDay==1){ak.innerHTML="<b>"+(n[ae].isLeap?"闰":"")+n[ae].lMonth+"月"+(I(n[ae].lYear,n[ae].lMonth)==29?"小":"大")+"</b>"}else{ak.innerHTML=M(n[ae].lDay)}var X=null,W=null;aa=n[ae].solarFestival;for(var ah=0;ah<h.length;ah++){if(parseInt(h[ah].substr(0,2))==(n[ae].lMonth)){if(parseInt(h[ah].substr(2,4))==(n[ae].lDay)){ak.innerHTML=h[ah].substr(5);X=h[ah].substr(5)}}if(12==(n[ae].lMonth)){if(F==(n[ae].lDay)){ak.innerHTML="除夕";X="除夕"}}}for(var ah=0;ah<a.length;ah++){if(parseInt(a[ah].substr(0,2))==(ad+1)){if(parseInt(a[ah].substr(2,4))==(ae+1)){ak.innerHTML=a[ah].substr(5);W=a[ah].substr(5)}}}if((ad+1)==5){if(r==0){if((ae+1)==7){W="母亲节";ak.innerHTML="母亲节"}}else{if(r<9){if((ae+1)==((7-r)+8)){W="母亲节";ak.innerHTML="母亲节"}}}}if((ad+1)==6){if(x==0){if((ae+1)==14){W="父亲节";ak.innerHTML="父亲节"}}else{if(x<9){if((ae+1)==((7-x)+15)){W="父亲节";ak.innerHTML="父亲节"}}}}if(aa.length<=0){aa=n[ae].solarTerms;if(aa.length>0){aa=aa.fontcolor("limegreen")}}if(aa.length>0){ak.innerHTML=aa;X=aa}if((X!=null)&&(W!=null)){ak.innerHTML=X+"/"+W}}else{V.addClass("disable");V.attr("data-value","");if(ae<0){var ac=new Date(ad>0?Z:Z-1,ad>0?ad:12,0).getDate();al.innerHTML=ac+ae+1;ak.innerHTML=""}else{al.innerHTML=ae-n.length+1;ak.innerHTML=""}}}b.find(".date-grid.active").removeClass("active");if(null!=R){if(q==R.year&&A==R.month){b.find('.date-grid[data-value="'+R.date+'"]').addClass("active")}}l.onChange(q,A+1)};var m=new Date().getFullYear(),t=new Date().getMonth(),w=new Date().getDate();var v=function(ac){var W,S=0,ae=0;var T=new Date(1900,0,31);var V=(ac-T)/86400000;var X=V+40;var ad=14;for(W=1900;W<2050&&V>0;W++){ae=e(W);V-=ae;ad+=12}if(V<0){V+=ae;W--;ad-=12}var Z=W;var U=W-1864;S=G(W);var ab=false;for(W=1;W<13&&V>0;W++){if(S>0&&W==(S+1)&&ab==false){--W;ab=true;ae=f(Z)}else{ae=I(Z,W)}if(ab==true&&W==(S+1)){ab=false}V-=ae;if(ab==false){ad++}}if(V==0&&S>0&&W==S+1){if(ab){ab=false}else{ab=true;--W;--ad}}if(V<0){V+=ae;--W;--ad}var Y=W;var aa=V+1;return{dayCyl:X,monCyl:ad,year:Z,yearCyl:U,isLeap:ab,month:Y,day:aa}};var z=function(Z,S,X,W,T,Y,V,U){return{isToday:false,sYear:Z,sMonth:S,sDay:X,week:W,lYear:T,lMonth:Y,lDay:V,isLeap:U,lunarFestival:"",solarFestival:"",solarTerms:""}};var H=function(ag,X){r=x=0;var ah,aa,ae,T,ad=1,U,af=0,Z,Y;var V=new Array(3);var W=0;var S=0;ah=new Date(ag,X,1);var ac={};ac.length=J(ag,X);ac.firstWeek=ah.getDay();if((X+1)==5){r=ah.getDay()}if((X+1)==6){x=ah.getDay()}for(var ab=0;ab<ac.length;ab++){if(ad>af){ah=new Date(ag,X,ab+1);aa=v(ah);ae=aa.year;T=aa.month;ad=aa.day;U=aa.isLeap;af=U?f(ae):I(ae,T);if(T==12){F=af}if(W==0){S=T}V[W++]=ab-ad+1}ac[ab]=z(ag,X+1,ab+1,L[(ab+ac.firstWeek)%7],ae,T,ad++,U);if((ab+ac.firstWeek)%7==0){ac[ab].color="red"}}Z=Q(ag,X*2)-1;Y=Q(ag,X*2+1)-1;ac[Z].solarTerms=o[X*2];ac[Y].solarTerms=o[X*2+1];if((ac.firstWeek+12)%7==5){ac[12].solarFestival+="黑色星期五"}if(ag==m&&X==t){ac[w-1].isToday=true}return ac};var D=function(){for(var W=0;W<6;W++){var V=document.createElement("div");if(W==5){V.className="date-grid-row last"}else{V.className="date-grid-row"}for(var U=0;U<7;U++){var T=W*7+U;var S=document.createElement("div");S.id="GD"+T;if(U==6){S.className="date-grid last"}else{S.className="date-grid"}var Y=document.createElement("span");Y.id="SD"+T;Y.className="sd";var X=document.createElement("span");X.id="LD"+T;X.className="ld";S.appendChild(Y);S.appendChild(X);V.appendChild(S)}i[0].appendChild(V)}};this.enableView=function(){var U='<div class="console"><div class="year"><div class="prev-btn">&lt;</div><div class="next-btn">&gt;</div><div class="label"></div></div><div class="month"><div class="prev-btn">&lt;</div><div class="next-btn">&gt;</div><div class="label"></div></div></div>';var S='<div class="week"><div class="label">日</div><div class="label">一</div><div class="label">二</div><div class="label">三</div><div class="label">四</div><div class="label">五</div><div class="label">六</div></div>';var T='<div class="grids"></div>';b.append(U+S+T);i=b.find(".grids");D();s(m,t);b.find(".console .year .prev-btn").click(function(){l.prevYear()});b.find(".console .year .next-btn").click(function(){l.nextYear()});b.find(".console .month .prev-btn").click(function(){l.prevMonth()});b.find(".console .month .next-btn").click(function(){l.nextMonth()})};var P,O;this.enableFormControl=function(T){k=b;b=null;var S=false;P=function(){if(!S){S=true;var U=k.offset().left;var Z=k.offset().top+k.outerHeight();var Y=$("body").width()-$("body").offset().left;var X=$("body").height()-$("body").offset().top;if(U+308>Y){U=Y-313}if(Z+339>X){Z=X-344}var V="left: "+U+"px; top: "+Z+"px;";b=$('<div id="__gust_calender_container" class="'+(T?T:"")+'" style="'+V+'"></div>').appendTo("body");l.enableView();if(""!=k.val()){var W=k.val().split("-");if(W.length>=3){C(parseInt(W[0]),parseInt(W[1]),parseInt(W[2]))}}O=function(aa){if($(aa.target).closest(b).length==0){S=false;b.empty();b.remove();document.body.removeEventListener("click",O,true)}};document.body.addEventListener("click",O,true);b.find(".grids .date-grid").click(function(){if(!$(this).hasClass("disable")){b.find(".grids .date-grid.active").removeClass("active");$(this).addClass("active");S=false;b.empty();b.remove();document.body.removeEventListener("click",O,true);var aa=A+1;var ab=$(this).find(".sd").html();k.val(q+"-"+(aa<10?"0"+aa:aa)+"-"+(ab<10?"0"+ab:ab));if(typeof l.onChoose=="function"){l.onChoose(q,aa,ab)}}})}};k[0].addEventListener("click",P,true)};this.destroy=function(){if(null!=b){b.empty()}if(null!=k){k[0].removeEventListener("click",P,true);if(null!=b){b.remove()}}if(null!=O){document.body.removeEventListener("click",O,true)}k=null;P=null;O=null;b=null};this.prevYear=function(){if(q==1900){s(2050,A)}else{s(q-1,A)}};this.nextYear=function(){if(q==2050){s(1900,A)}else{s(q+1,A)}};this.prevMonth=function(){if(A==0){s(q-1,11)}else{s(q,A-1)}};this.nextMonth=function(){if(A==11){s(q+1,0)}else{s(q,A+1)}};var C=function(T,U,S){if(null!=S){R={year:T,month:U-1,date:S}}if($("#__gust_calender_container").length>0){s(T,U-1)}};this.gotoDate=function(T,U,S){C(T,U,S);if(typeof this.onChoose=="function"){this.onChoose(T,U,S)}};this.getYear=function(){return q};this.getMonth=function(){return A};this.onChange=function(S,T){};this.onChoose=function(T,U,S){}};