var GustCalendar=function(b,f,n){var c,w,s,m,z,H,G,a,g,x=0,o=0,M=0,h,j;var i=function(N){var O=[];for(var P=0;P<N.length;P++){O[P]=parseInt(N[P],10)}return O};if(null!=f){f=i(f.split("-"))}if(null!=n){n=i(n.split("-"))}(function(){c=[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42448,83315,21200,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46496,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448];w=[31,28,31,30,31,30,31,31,30,31,30,31];s=["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"];m=["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"];z=[0,21208,42467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758];H=["日","一","二","三","四","五","六","七","八","九","十"];G=["初","十","廿","卅"];a=["0101 元旦","0214 情人节","0308 妇女节","0312 植树节","0315 消费者权益日","0401 愚人节","0501 劳动节","0504 青年节","0512 护士节","0601 儿童节","0701 建党节","0801 建军节","0910 教师节","0928 孔子诞辰","1001 国庆节","1006 老人节","1024 联合国日","1224 平安夜","1225 圣诞节"];g=["0101 春节","0115 元宵节","0505 端午节","0707 七夕节","0715 中元节","0815 中秋节","0909 重阳节","1208 腊八节","1224 小年"]})();var d=function(P){var N,O=348;for(N=32768;N>8;N>>=1){O+=(c[P-1900]&N)?1:0}return(O+e(P))};var e=function(N){if(C(N)){return((c[N-1900]&65536)?30:29)}else{return(0)}};var C=function(N){return(c[N-1900]&15)};var E=function(O,N){return((c[O-1900]&(65536>>N))?30:29)};var F=function(O,N){if(N==1){return(((O%4==0)&&(O%100!=0)||(O%400==0))?29:28)}else{return(w[N])}};var L=function(P,O){var N=new Date((31556925974.7*(P-1900)+z[O]*60000)+Date.UTC(1900,0,6,2,5));return(N.getUTCDate())};var p=9,v=9,B=0;var I=function(O){var N;switch(O){case 10:N="初十";break;case 20:N="二十";break;break;case 30:N="三十";break;break;default:N=G[Math.floor(O/10)];N+=H[O%10]}return(N)};var l;var q=function(U,Y){o=U;x=Y;b.find(".console .year .label").text(U+"年");b.find(".console .month .label").text((Y+1)+"月");var ab,Z,V;l=D(U,Y);var W=s[(U-4)%12];var N=false,aa=false,T=false,ah=false;if(null!=f){var ae=f[0],P=f[1];N=(U<ae)||(U==ae&&Y+1<P);aa=(U==ae)&&(Y+1==P)}if(null!=n){var ad=n[0],O=n[1];T=(U>ad)||(U==ad&&Y+1>O);ah=(U==ad)&&(Y+1==O)}for(ab=0;ab<42;ab++){var Q=h.find("#GD"+ab);var ag=h.find("#SD"+ab)[0];var af=h.find("#LD"+ab)[0];Z=ab-l.firstWeek;if(Z>-1&&Z<l.length){if((N||(aa&&(Z+1)<f[2]))||(T||(ah&&(Z+1)>n[2]))){Q.addClass("disable")}else{Q.removeClass("disable")}ag.innerHTML=Z+1;Q.attr("data-value",Z+1);if(l[Z].isToday){Q.addClass("today")}else{Q.removeClass("today")}if(l[Z].lDay==1){af.innerHTML="<b>"+(l[Z].isLeap?"闰":"")+l[Z].lMonth+"月"+(E(l[Z].lYear,l[Z].lMonth)==29?"小":"大")+"</b>"}else{af.innerHTML=I(l[Z].lDay)}var S=null,R=null;V=l[Z].solarFestival;for(var ac=0;ac<g.length;ac++){if(parseInt(g[ac].substr(0,2))==(l[Z].lMonth)){if(parseInt(g[ac].substr(2,4))==(l[Z].lDay)){af.innerHTML=g[ac].substr(5);S=g[ac].substr(5)}}if(12==(l[Z].lMonth)){if(B==(l[Z].lDay)){af.innerHTML="除夕";S="除夕"}}}for(var ac=0;ac<a.length;ac++){if(parseInt(a[ac].substr(0,2))==(Y+1)){if(parseInt(a[ac].substr(2,4))==(Z+1)){af.innerHTML=a[ac].substr(5);R=a[ac].substr(5)}}}if((Y+1)==5){if(p==0){if((Z+1)==7){R="母亲节";af.innerHTML="母亲节"}}else{if(p<9){if((Z+1)==((7-p)+8)){R="母亲节";af.innerHTML="母亲节"}}}}if((Y+1)==6){if(v==0){if((Z+1)==14){R="父亲节";af.innerHTML="父亲节"}}else{if(v<9){if((Z+1)==((7-v)+15)){R="父亲节";af.innerHTML="父亲节"}}}}if(V.length<=0){V=l[Z].solarTerms;if(V.length>0){V=V.fontcolor("limegreen")}}if(V.length>0){af.innerHTML=V;S=V}if((S!=null)&&(R!=null)){af.innerHTML=S+"/"+R}}else{Q.addClass("disable");Q.attr("data-value","");if(Z<0){var X=new Date(Y>0?U:U-1,Y>0?Y:12,0).getDate();ag.innerHTML=X+Z+1;af.innerHTML=""}else{ag.innerHTML=Z-l.length+1;af.innerHTML=""}}}b.find(".date-grid.active").removeClass("active");if(null!=M){if(o==M.year&&x==M.month){b.find('.date-grid[data-value="'+M.date+'"]').addClass("active")}}};var k=new Date().getFullYear(),r=new Date().getMonth(),u=new Date().getDate();var t=function(X){var R,N=0,Z=0;var O=new Date(1900,0,31);var Q=(X-O)/86400000;var S=Q+40;var Y=14;for(R=1900;R<2050&&Q>0;R++){Z=d(R);Q-=Z;Y+=12}if(Q<0){Q+=Z;R--;Y-=12}var U=R;var P=R-1864;N=C(R);var W=false;for(R=1;R<13&&Q>0;R++){if(N>0&&R==(N+1)&&W==false){--R;W=true;Z=e(U)}else{Z=E(U,R)}if(W==true&&R==(N+1)){W=false}Q-=Z;if(W==false){Y++}}if(Q==0&&N>0&&R==N+1){if(W){W=false}else{W=true;--R;--Y}}if(Q<0){Q+=Z;--R;--Y}var T=R;var V=Q+1;return{dayCyl:S,monCyl:Y,year:U,yearCyl:P,isLeap:W,month:T,day:V}};var y=function(U,N,S,R,O,T,Q,P){return{isToday:false,sYear:U,sMonth:N,sDay:S,week:R,lYear:O,lMonth:T,lDay:Q,isLeap:P,lunarFestival:"",solarFestival:"",solarTerms:""}};var D=function(ab,S){p=v=0;var ac,V,Z,O,Y=1,P,aa=0,U,T;var Q=new Array(3);var R=0;var N=0;ac=new Date(ab,S,1);var X={};X.length=F(ab,S);X.firstWeek=ac.getDay();if((S+1)==5){p=ac.getDay()}if((S+1)==6){v=ac.getDay()}for(var W=0;W<X.length;W++){if(Y>aa){ac=new Date(ab,S,W+1);V=t(ac);Z=V.year;O=V.month;Y=V.day;P=V.isLeap;aa=P?e(Z):E(Z,O);if(O==12){B=aa}if(R==0){N=O}Q[R++]=W-Y+1}X[W]=y(ab,S+1,W+1,H[(W+X.firstWeek)%7],Z,O,Y++,P);if((W+X.firstWeek)%7==0){X[W].color="red"}}U=L(ab,S*2)-1;T=L(ab,S*2+1)-1;X[U].solarTerms=m[S*2];X[T].solarTerms=m[S*2+1];if((X.firstWeek+12)%7==5){X[12].solarFestival+="黑色星期五"}if(ab==k&&S==r){X[u-1].isToday=true}return X};var A=function(){for(var R=0;R<6;R++){var Q=document.createElement("div");if(R==5){Q.className="date-grid-row last"}else{Q.className="date-grid-row"}for(var P=0;P<7;P++){var O=R*7+P;var N=document.createElement("div");N.id="GD"+O;if(P==6){N.className="date-grid last"}else{N.className="date-grid"}var T=document.createElement("span");T.id="SD"+O;T.className="sd";var S=document.createElement("span");S.id="LD"+O;S.className="ld";N.appendChild(T);N.appendChild(S);Q.appendChild(N)}h[0].appendChild(Q)}};this.enableView=function(){var Q='<div class="console"><div class="year"><div class="prev-btn">&lt;</div><div class="next-btn">&gt;</div><div class="label"></div></div><div class="month"><div class="prev-btn">&lt;</div><div class="next-btn">&gt;</div><div class="label"></div></div></div>';var O='<div class="week"><div class="label">日</div><div class="label">一</div><div class="label">二</div><div class="label">三</div><div class="label">四</div><div class="label">五</div><div class="label">六</div></div>';var P='<div class="grids"></div>';b.append(Q+O+P);h=b.find(".grids");A();q(k,r);var N=this;b.find(".console .year .prev-btn").click(function(){N.prevYear()});b.find(".console .year .next-btn").click(function(){N.nextYear()});b.find(".console .month .prev-btn").click(function(){N.prevMonth()});b.find(".console .month .next-btn").click(function(){N.nextMonth()})};var K,J;this.enableFormControl=function(){j=b;var N=this;var O=false;K=function(){if(!O){O=true;var P=j.offset().left;var U=j.offset().top+j.outerHeight();var T=$("body").width()-$("body").offset().left;var S=$("body").height()-$("body").offset().top;if(P+308>T){P=T-313}if(U+339>S){U=S-344}var Q="left: "+P+"px; top: "+U+"px;";b=$('<div id="__gust_calender_container" style="'+Q+'"></div>').appendTo("body");N.enableView();if(""!=j.val()){var R=j.val().split("-");if(R.length>=3){N.gotoDate(parseInt(R[0]),parseInt(R[1]),parseInt(R[2]))}}J=function(V){if($(V.target).closest(b).length==0){O=false;b.empty();b.remove();document.body.removeEventListener("click",J,true)}};document.body.addEventListener("click",J,true);b.find(".grids .date-grid").click(function(){if(!$(this).hasClass("disable")){b.find(".grids .date-grid.active").removeClass("active");$(this).addClass("active");O=false;b.empty();b.remove();document.body.removeEventListener("click",J,true);var V=x+1;var W=$(this).find(".sd").html();j.val(o+"-"+(V<10?"0"+V:V)+"-"+(W<10?"0"+W:W))}})}};j[0].addEventListener("click",K,true)};this.destroy=function(){b.empty();if(null!=j){j[0].removeEventListener("click",K,true);if(null!=b){b.remove()}}if(null!=J){document.body.removeEventListener("click",J,true)}j=null;K=null;J=null;b=null};this.prevYear=function(){if(o==1900){q(2050,x)}else{q(o-1,x)}};this.nextYear=function(){if(o==2050){q(1900,x)}else{q(o+1,x)}};this.prevMonth=function(){if(x==0){q(o-1,11)}else{q(o,x-1)}};this.nextMonth=function(){if(x==11){q(o+1,0)}else{q(o,x+1)}};this.gotoDate=function(O,P,N){if(null!=N){M={year:O,month:P-1,date:N}}q(O,P-1)};this.getYear=function(){return o};this.getMonth=function(){return x}};